<!doctype html><html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title></title><link rel=stylesheet href=/pixtudio-website/main.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=apple-touch-icon sizes=180x180 href=https://divhub.github.io/pixtudio-website/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://divhub.github.io/pixtudio-website/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://divhub.github.io/pixtudio-website/favicon-16x16.png><link rel=manifest href=https://divhub.github.io/pixtudio-website/site.webmanifest><link rel=mask-icon href=https://divhub.github.io/pixtudio-website/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><body><nav class="navbar is-primary"><div class=container><div class=navbar-brand><a href=https://divhub.github.io/pixtudio-website/ class=navbar-item>PixTudio</a>
<span class="navbar-burger burger" data-target=main-navbar><span></span><span></span><span></span></span></div><div class=navbar-menu id=main-navbar><div class="navbar-end has-text-centered-mobile"><a class=navbar-item title=Docs href=/pixtudio-website/docs/>Docs
</a><a class=navbar-item title=Compile href=/pixtudio-website/compile/>Compile</a></div></div></div></nav><script>document.addEventListener('DOMContentLoaded',()=>{const $navbarBurgers=Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'),0);if($navbarBurgers.length>0){$navbarBurgers.forEach(el=>{el.addEventListener('click',()=>{const target=el.dataset.target;const $target=document.getElementById(target);el.classList.toggle('is-active');$target.classList.toggle('is-active');});});}});</script><div class=section><div class=container><div class=columns><div class="column is-3"><div id=search-section><div id=search-form class=field><div class=control><input id=search-input class=input type=text placeholder="Search Docs"></div></div><div id=search-results-box class=box style=max-height:40%;overflow:hidden;overflow-y:auto;position:absolute;display:none><ul id=search-results-list></ul><div id=search-results-noresults class="notification is-info">No results found.</div></div></div><aside class=menu><ul class=menu-list><li><a href=https://divhub.github.io/pixtudio-website/docs/>Docs</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/general/>General</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/language/>Language</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/modules/>Modules</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/functions/>Functions</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/variables/>Variables</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/constants/>Constants</a></li><li><a href=https://divhub.github.io/pixtudio-website/docs/guides/>Guides and Tutorials</a></li></ul></aside></div><div class="column is-6"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://divhub.github.io/pixtudio-website/docs/>PixTudio Documentation</a></li><li class=is-active><a href=https://divhub.github.io/pixtudio-website/docs/map_format_specification/ aria-current=page></a></li></ul></nav><h1 class="title is-2"></h1><div class=content><h2 id=format-specification>Format Specification</h2><p>This section describes the structure of a <a href=MAP title=wikilink>MAP</a> file. It
is not necessary to know these details to program games in
<a href=Bennu title=wikilink>Bennu</a>, but they will be of help for those who want
to develop external tools which are able to read or write MAP files.</p><p>A <a href=MAP title=wikilink>MAP</a> file does not have compression.
<a href=Bennu title=wikilink>Bennu</a>, however, supports transparently
<a href=http://en.wikipedia.org/wiki/Gzip>GZIP</a> compression in files and
usually MAP files are saved to disk compressed with GZIP. In the
following we will assume that the MAP file is not compressed.</p><h3 id=header-0>Header (+0)</h3><p><a href=MAP title=wikilink>MAP</a> files start with the following header (8 bytes).</p><p>Name Size (bytes) Description</p><hr><p>MAGIC 3 Three character string identifying the <a href=MAP title=wikilink>MAP</a> file. Must contain &ldquo;m01&rdquo;, &ldquo;map&rdquo;, &ldquo;m16&rdquo; or &ldquo;m32&rdquo;, in lower case. Depending on these value the information in the MAP file will refer to a 1 (m01), 8 (map), 16 (m16) or 32 (m32) bits per pixel (depth) MAP.
MS-DOS Termination 4 The following bytes: 0x1A, 0x0D, 0x0A y 0x00. This termination will prevent a TYPE (in MS-DOS) command to show the binary data of the file.
VERSION 1 Version number. The byte 0x00 for the specification in this document.</p><p><em>Subtotal: 8 bytes</em></p><h3 id=descriptor-8>Descriptor (+8)</h3><p>Following the header there are 40 bytes which describes the
<a href=MAP title=wikilink>MAP</a> file. This section can be understood as an
extension of the header.</p><p>Name Size (bytes) Description</p><hr><p>WIDTH 2 The width in pixels of the graphic.
HEIGHT 2 The height in pixels of the graphic.
CODE 4 The <a href=GraphID title=wikilink>GraphID</a> of the graphic. <a href=Bennu title=wikilink>Bennu</a> ignores this value (a <a href=MAP title=wikilink>MAP</a> loaded in Bennu will not have a graphID unless it is inside an <a href=FPG title=wikilink>FPG</a>). This field, however, is kept for backwards compatibility with <a href=DIV title=wikilink>DIV</a> and <a href=Fenix title=wikilink>Fenix</a>. When writing MAP files for Bennu you should always use 0.
NAME 32 A 32 bytes string which may be used to briefly identify by name the contents of the graphic. If the length of the description is less than 32 bytes, the string must be null-terminated (last character must be &lsquo;\0&rsquo;).</p><p><em>Subtotal: 40 bytes</em></p><h3 id=palette-48>Palette (+48)</h3><p>See <a href=PAL#Palette title=wikilink>PAL</a>.</p><p>Name Size (bytes) Description</p><hr><p>PALETTE 768 See <a href=PAL#Palette title=wikilink>PAL</a>.</p><p><em>Subtotal: 768 bytes</em></p><h3 id=ranges-of-colours-816>Ranges of Colours (+816)</h3><p>See <a href=PAL#Range_of_Colours title=wikilink>PAL</a>.</p><p>Name Size (bytes) Description</p><hr><p>RANGE OF COLOURS 576 See <a href=PAL#Range_of_Colours title=wikilink>PAL</a>.</p><p><em>Subtotal: 576 bytes</em></p><h3 id=control-points-1392>Control Points (+1392)</h3><p>A section to store <a href=control_point title=wikilink>control points</a>.</p><hr><p>Name Size (bytes) Description</p><hr><p>NUMBER OF CONTROL POINTS 2 The number of control points stored in this MAP.</p><p>CONTROL POINTS <em>x</em> Size Description
&mdash;&mdash; &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;
2 X coordinate of the first control point.
2 Y coordinate of the first control point.
&hellip; &hellip;
2 X coordinate of the last control point.
2 Y coordinate of the last control point.</p><pre><code>                                        The [control points](control_point &quot;wikilink&quot;). The coordinates of a control point are stored together in 4 bytes: first 2 for the x coordinate, last 2 for the y coordinate. This is repeated as many times as there are control points stored.

                                        *x = 4 \* (number of control points)*
</code></pre><hr><p><em>Subtotal: 2 + (4 * (number of control points) ) bytes</em></p><h3 id=graphic-data-1394-4-number-of-control-points>Graphic data (+1394+4*(number of control points))</h3><p>The actual graphic data.</p><hr><p>Name Size (bytes) Description</p><hr><p>GRAPHIC DATA <em>x</em> &mdash;&mdash;&mdash;- &mdash;&mdash;&mdash;- &mdash;&mdash;&mdash;- &mdash;&mdash;&mdash;-
0 (+0) 1 (+2) 2 (+4) 3 (+6)
4 (+8) 5 (+10) 6 (+12) 7 (+14)
8 (+16) 8 (+18) 10 (+20) 11 (+22)
12 (+24) 13 (+26) 14 (+28) 15 (+30)
&mdash;&mdash;&mdash;- &mdash;&mdash;&mdash;- &mdash;&mdash;&mdash;- &mdash;&mdash;&mdash;-</p><pre><code>                            The depth of the graphic (see [Header](#Header_(+0) &quot;wikilink&quot;)) determines how the data is stored.

                            1bpp graphics: Pixels are stored by rows. Each byte stores up to 8 pixels, meaning that a pixel is stored in one bit. If the width of the image in pixels is not multiple of 8, last byte of the row will contain up to 7 unused bits (least significant bits). [Bennu](Bennu &quot;wikilink&quot;) ignores these bits so they can be set either to 0 or 1.

                            8bpp graphics: Each pixel is stored in one byte. The value stored does not represent the color, but an index to the 256-color palette (see [Palette](#Palette_(+48) &quot;wikilink&quot;)). All pixels are stored consecutively, i.e., there is no padding.

                            16bpp graphics: Each pixel uses 2 bytes to store the color of the pixel. The color is in RGB565 format, meaning the first 5 most significant bits are used to store the red component, next 6 to store the green component and last 5 least significant bits store the blue component. Although this format does not contain information on alpha, [Bennu](Bennu &quot;wikilink&quot;) understands color 0x0000 as transparent. All pixels are stored consecutively, i.e., there is no padding.

                            The example to the right shows a 16bit 4x4 graphic, with pixel numbers outside and byte offset inside the parenthesis.

                            32bpp graphics: Each pixel uses 4 bytes to store the color of the pixel. The color is in ARGB format, 8 bits for alpha component, 8 bits for red, 8 bits for green and 8 bits for blue. A pixel with an alpha component set to 0xFFFFFFFF is totally opaque while if set to 0x00000000 it will be completely transparent. All pixels are stored consecutively, i.e., there is no padding.

                            *x = (width + ((8 - (width % 8)) &amp; 7)) / 8 \* height* (depth in bytes -1bpp graphics-)

                            *x = width \* height \* depth/8* (depth in bytes -8, 16, 32bpp graphics-)
</code></pre><hr><p><em>Subtotal: width * height * depth/8 bytes</em> (depth in bytes)</p><p><strong><em>Total: 1394 + (4*(number of control points)) + (width * height *
depth/8) bytes</em></strong></p></div></div><div class="column is-3"><nav id=TableOfContents><ul><li><ul><li><a href=#format-specification>Format Specification</a><ul><li><a href=#header-0>Header (+0)</a></li><li><a href=#descriptor-8>Descriptor (+8)</a></li><li><a href=#palette-48>Palette (+48)</a></li><li><a href=#ranges-of-colours-816>Ranges of Colours (+816)</a></li><li><a href=#control-points-1392>Control Points (+1392)</a></li><li><a href=#graphic-data-1394-4-number-of-control-points>Graphic data (+1394+4*(number of control points))</a></li></ul></li></ul></li></ul></nav></div></div></div></div><footer class=footer><div class="container has-text-centered"><div class="footer-section footer-logo-section margin-2"><p>PixTudio | A 2D game engine for Windows, Linux, OS X, Android &amp; iOS.</p></div><div class="footer-section footer-copyright-section"><p>Made with ❤️ |
Design by <a href=https://tehuel.blog>Tehuel</a>
| <a href=https://github.com/DivHub/pixtudio-website/edit/master/content/docs/map_format_specification.md>Edit this page on Github</a></p></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.3.0/fuse.min.js></script><script src=/pixtudio-website/js/search.min.80a2eb909ba11ec0900ab4ae5fbfcf2d.js></script></body></html>